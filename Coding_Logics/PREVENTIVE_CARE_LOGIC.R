## Preventive Care Logic

prev_care <- function(icd_10, icd_9, proc_code){
  
  x <- case_when(
    
    ###### Preventive Care Logic ######
    
    (icd_10 %in% c('Z87.891', 'Z00.00', 'Z00.01', 'Z13.6') |
       icd_9 %in% c('V15.82', 'V70.0', 'V81.1', 'V81.2')) &
      proc_code %in% c('76770', '76775', 'G0389')                               ~ "Aortography",
    
    proc_code %in% c('99497', '99498')                                          ~ "Advanced Planning",
    
    (icd_10 %in% c('Z80.3', 'Z80.41', 'Z80.49', 'Z85.3', 'Z85.43', 'Z15.01') |
       icd_9 %in% c('V16.3', 'V16.41', 'V16.40', 'V16.49', 'V10.3', 'V10.43', 
                    'V84.01')) & 
      proc_code %in% c('81211', '81212', '81213', '81214', '81215', '81216', 
                       '81217', '96040', 'S0265')                               ~ "BRCA Screening",
    
    ((str_sub(icd_10, 1, 3) %in% c('Z11', 'Z12', 'Z13') |
        str_sub(icd_9, 1, 3) %in% c('V73', 'V74', 'V75', 'V76', 'V77', 'V78', 
                                    'V79', 'V80', 'V81', 'V82')) &
       proc_code %in% c('77052', '77057', '77063', 'G0202', 'U401')) | 
      ((icd_10 %in% c('Z85.3', 'Z80.3', 'Z12.31', 'Z12.39') |
          icd_9 %in% c('V10.3', 'V16.3', 'V76.12', 'V76.10', 'V76.19')) & 
         proc_code %in% c('77051', '77055', '77056', 'G0204', 'G0206', 'U401')) ~ "Breast Cancer Screening",
    
    proc_code %in% c('G0123', 'G0124', 'G0141', 'G0142', 'G0143', 'G0144', 
                     'G0145', 'G0146', 'G0147', 'G0148') | 
      ((icd_10 %in% c('Z00.00', 'Z00.01', 'Z00.121', 'Z00.129', 'Z01.411', 
                      'Z01.419', 'Z12.4', 'Z12.72', 'Z72.51', 'Z72.52', 
                      'Z72.53', 'Z80.41', 'Z80.49') | 
          icd_9 %in% c('V70.0', 'V20.2', 'V72.31', 'V76.2', 'V76.47', 'V69.2', 
                       'V16.41', 'V16.40', 'V16.49')) & 
         proc_code %in% c('88141', '88142', '88143', '88144', '88145', '88146', 
                          '88147', '88148', '88149', '88150', '88151', '88152', 
                          '88153', '88154', '88155', '88164', '88165', '88166', 
                          '88167', '88174', '88175', 'Q0091', 'U923'))          ~ "Pap-Smear",
    
    (icd_10 %in% c('Z00.00', 'Z00.01', 'Z01.411', 'Z01.419', 'Z11.3', 'Z11.4',
                   'Z11.51', 'Z11.59', 'Z12.4', 'Z12.72', 'Z71.89', 'Z72.51',
                   'Z72.52', 'Z72.53', 'Z80.41', 'Z80.49') |
       icd_9 %in% c('V70.0', 'V72.31', 'V73.89', 'V74.5', 'V73.0', 
                    'V73.2', 'V73.3', 'V73.4', 'V73.5', 'V73.89', 
                    'V73.81', 'V76.2','V76.47', 'V65.49', 'V69.2', 
                    'V16.41', 'V16.40', 'V16.49')) & 
      proc_code %in% c('87623', '87624', '87625')                               ~ "HPV Screening",
    
    ((icd_10 %in% c('Z12.11', 'Z12.12', 'Z80.0', 'Z83.71', 'Z85.00', 'Z85.01',
                    'Z85.05', 'Z85.060', 'Z85.068', 'Z85.07', 'Z85.09', 'Z86.01',
                    'Z85.020', 'Z85.028', 'Z85.030', 'Z85.038', 'Z85.040',
                    'Z85.048', 'Z85.810', 'Z85.818', 'Z85.819', 'Z86.010') |
        icd_9 %in% c('V10.00', 'V10.03', 'V12.72', 'V76.51', 'V76.41', 'V16.0',
                     'V18.51', 'V10.91', 'V10.04', 'V10.05', 'V10.06', 'V10.01',
                     'V10.07', 'V10.09')) & 
       proc_code %in% c('45330', '45331', '45333', '45334', '45335', '45338', 
                        '45346', '45378', '45380', '45381', '45382', '45383', 
                        '45384', '45385', '45388', 'G0104', 'G0105', 'G0121', 
                        '88305', 'S0285', '00810', '81528')) |
      (proc_code == '74623') | 
      ((icd_10 %in% c('Z00.00', 'Z00.01', 'Z12.11', 'Z12.12', 'Z80.0', 'Z83.71',
                      'Z85.00', 'Z85.01', 'Z85.020', 'Z85.028', 'Z85.030',
                      'Z85.038', 'Z85.040', 'Z85.048', 'Z85.810', 'Z85.818',
                      'Z85.819', 'Z86.010') |
          icd_9 %in% c('V70.0', 'V10.00', 'V10.03', 'V10.02', 'V12.72', 
                       'V76.41', 'V16.0', 'V18.51', 'V10.91', 'V10.04',  
                       'V10.06', 'V10.01', 'V76.51', 'V10.05')) & 
         proc_code %in% c('82270', '82274', 'G0328'))                           ~ "Screening Colorectal Cancer",
    
    (str_sub(icd_10,1, 3) == 'Z30' | 
       str_sub(icd_9,1, 3) == 'V25' | 
       icd_10 %in% c('Z31.61', 'Z31.62', 'Z31.69', 'Z31.41', 'Z97.5') |
       icd_9 %in% c('V26.41', 'V26.42', 'V26.49', 
                    'V26.21', 'V45.51', 'V45.59')) & 
      proc_code %in% c('81025', '57170', '58300', '58301', '11976', '11981', 
                       '11982', '11983', '96372', '99201', '99202', '99203', 
                       '99204', '99205', '99211', '99212', '99213', '99214', 
                       '99215', 'A4261', 'A4266', 'J7303', 'J7304', 'J7297', 
                       'J7298', 'J7300', 'J7301', 'J7306', 'J7307', 'J1050')    ~ "Contraception",
    
    proc_code == '96110'                                                        ~ "Autism Screening",
    
    (icd_10 %in% c('Z00.00', 'Z00.01', 'Z01.411', 'Z01.419', 'Z13.1') |
       icd_9 %in% c('V70.0', 'V72.31', 'V77.1')) &
      proc_code %in% c('82947', '82948', '83036')                               ~ "Diabetes Screening",
    
    (icd_10 %in% c('Z00.00', 'Z00.01', 'Z01.411', 
                   'Z01.419', 'Z72.4', 'Z71.3') |
       icd_9 %in% c('V70.0', 'V72.31', 'V69.1', 'V65.3')) & 
      proc_code %in% c('97802', '97803', '97804')                               ~ "Dietary Counselling",
    
    (icd_10 %in% c('Z01.20', 'Z01.21') |
       icd_9 %in% c('V72.2')) &
      proc_code == '9918'                                                       ~ "Dental Wash",
    
    (icd_10 %in% c('Z01.10', 'Z01.110', 'Z01.118', 'Z01.12') |
       icd_9 %in% c('V72.19', 'V72.11', 'V72.12')) &
      proc_code %in% c('92551', 'V5008')                                        ~ "Hearing Test",
    
    (icd_10 %in% c('Z00.00', 'Z00.01', 'Z00.110', 'Z00.111', 'Z00.121',
                   'Z00.129', 'Z00.2', 'Z00.3', 'Z01.411', 'Z01.419', 'Z12.4',
                   'Z12.72', 'Z76.1', 'Z76.2', 'Z80.0', 'Z85.00', 'Z85.01',
                   'Z85.05', 'Z85.060', 'Z85.068', 'Z85.07', 'Z85.09',
                   'Z85.020', 'Z85.028', 'Z85.030', 'Z85.038', 'Z85.040',
                   'Z85.048') |
       icd_9 %in% c('V70.0', 'V72.31', 'V76.2', 'V76.47', 'V20.2',
                    'V20.0', 'V20.1', 'V10.07', 'V10.09', 'V10.91', 
                    'V10.04', 'V10.05', 'V10.06', 'V20.31', 'V20.32',
                    'V16.0', 'V10.00', 'V10.03', 'V21.0', 'V21.1', 'V21.2')) &
      proc_code %in% c('85014', '85018')                                        ~ "Hematacrit Test",
    
    (icd_10 %in% c('Z00.00', 'Z00.01', 'Z01.411', 'Z01.419', 'Z11.4',
                   'Z11.59') |
       icd_9 %in% c('V70.0', 'V72.31', 'V73.89', 'V73.0', 'V73.2', 
                    'V73.3', 'V73.4', 'V73.5', 'V73.89')) & 
      proc_code %in% c('86704', '86705', '86706', '86707', '87340')             ~ "Hep B Screening",
    
    (icd_10 %in% c('Z00.00', 'Z00.01', 'Z01.411', 'Z01.419', 'Z11.4',
                   'Z11.59') |
       icd_9 %in% c('V70.0', 'V72.31', 'V73.89', 'V73.0', 'V73.2', 
                    'V73.3', 'V73.4', 'V73.5', 'V73.89')) &
      proc_code %in% c('86803', 'G0472')                                        ~ "Hep C Screening",
    
    (icd_10 %in% c('Z00.00', 'Z00.01', 'Z00.121', 'Z00.129', 'Z13.220',
                   'Z13.6') |
       icd_9 %in% c('V70.0', 'V20.2', 'V77.91', 'V81.1', 'V81.2')) &
      proc_code %in% c('82465', '83718', '83721', '84478', '80061')             ~ "Hyperlipidemia Test",
    
    (icd_10 %in% c('Z00.00', 'Z00.01', 'Z00.121', 'Z00.129', 'Z77.011') |
       icd_9 %in% c('V70.0', 'V20.2', 'V15.86')) &
      proc_code == '83655'                                                      ~ "Lead Test",
    
    proc_code == 'G0297'                                                        ~ "Lung Cancer Screening",
    
    (icd_10 %in% c('Z00.00', 'Z00.01', 'Z13.820', 'Z78.0') |
       icd_9 %in% c('V70.0', 'V82.81', 'V49.81')) & 
      proc_code %in% c('77080', '77085')                                        ~ "Osteoporoesis Screening",
    
    ((icd_10 %in% c('Z00.00', 'Z00.01', 'Z01.411', 'Z01.419', 
                    'Z11.3', 'Z11.4', 'Z11.59', 'Z71.7', 
                    'Z71.89', 'Z72.51', 'Z72.52', 'Z72.53' ) |
        icd_9 %in% c('V70.0', 'V72.31', 'V73.89', 'V74.5', 'V73.0', 'V73.2', 
                     'V73.3', 'V73.4', 'V73.5', 'V73.89', 'V65.49', 'V69.2',
                     'V65.44')) & 
       proc_code %in% c('86701', '86702', '86703', '87806')) | 
      (proc_code %in% c('G0432', 'G0433', 'G0435')) | 
      ((icd_10 %in% c('Z00.00', 'Z00.01', 'Z01.411', 'Z01.419', 'Z11.3',
                      'Z71.89', 'Z72.51', 'Z72.52', 'Z72.53') |
          icd_9 %in% c('V70.0', 'V72.31', 'V74.5', 'V65.49', 'V69.2')) &
         proc_code == '86592') |
      ((icd_10 %in% c('Z00.00', 'Z00.01', 'Z00.121', 'Z00.129', 'Z01.411',
                      'Z01.419', 'Z11.3', 'Z71.89', 'Z72.51', 'Z72.52',
                      'Z72.53') |
          icd_9 %in% c('V70.0', 'V72.31', 'V74.5', 
                       'V65.49', 'V69.2', 'V20.2')) &
         proc_code %in% c('87850', '87590', '87591', '87592')) |
      ((icd_10 %in% c('Z00.00', 'Z00.01', 'Z00.121', 'Z00.129', 
                      'Z01.411', 'Z01.419', 'Z11.3', 'Z11.8', 
                      'Z71.89', 'Z72.51', 'Z72.52', 'Z72.53') |
          icd_9 %in% c('V70.0', 'V72.31', 'V74.5', 'V65.49', 
                       'V69.2', 'V20.2', 'V73.88', 'V73.98',
                       'V74.8', 'V75.0', 'V75.1', 'V75.2',
                       'V75.3', 'V75.4', 'V75.5', 'V75.6', 'V75.8')) &
         proc_code %in% c('87110', '87270', '87320', 
                          '87490', '87491', '87492'))                           ~ "STD Testing",
    
    (icd_10 %in% c('Z30.2', 'Z98.51') |
       icd_9 %in% c('V25.2', 'V26.51')) &
      proc_code %in% c('58565', '58615', '58340', '74740', '00851', '00952', 
                       '58600', '58605', '58611', '58670', '58671')             ~ "Sterilization",
    
    (icd_10 %in% c('Z76.1', 'Z76.2', 'Z00.121', 'Z00.129') |
       icd_9 %in% c('V20.2', 'V20.0', 'V20.1')) &
      proc_code == '86580'                                                      ~ "Tuberculosis Test",
    
    proc_code %in% c('99381', '99382', '99383', '99384', '99385', '99386', 
                     '99387', '99391', '99392', '99393', '99394', '99395', 
                     '99396', '99397', '99401', '99402', '99403', '99404', 
                     '99406', '99407', '99408', '99409', '99411', '99412', 
                     '99429', '96160', '96161', '96127', '99420', '99460', 
                     '99461', '99462', '99463', 'G0447', 'G0436', 'G0446', 
                     'G0438', 'G0439', 'G0445', 'G0437', 'G0446', 'G0444', 
                     'G443', 'G442', 'U770', 'S0610', 'S0612', 'S0613')         ~ "Wellness Visit",
    
    (icd_10 %in% c('Z00.00', 'Z00.01', 'Z01.411', 'Z01.419', 'Z23') |
       icd_9 %in% c('V70.0', 'V72.31', 'V05.9')) &
      proc_code %in% c('90620', '90621', '90632', '90644', '90647', '99648', 
                       '99649', '99650', '90651', '90655', '90656', '90657', 
                       '90658', '90659', '90660', '90662', '90670', '90675', 
                       '90676', '90677', '90678', '90679', '90680', '90681', 
                       '90682', '90683', '90684', '90696', '90698', '90699', 
                       '90700', '90701', '90702', '90707', '90710', '90713', 
                       '90714', '90715', '90716', '90723', '90732', '90733', 
                       '90734', '90736', '90740', '90741', '90742', '90743', 
                       '90744', '90745', '90746', '90747', '90748' , '90460', 
                       '90461', '90462', '90463', '90464', '90465', '90466', 
                       '90467', '90468', '90469', '90470', '90471', '90472', 
                       '90473', '90474', 'U771')                                ~ "Vaccinations",
    
    (icd_10 %in% c('Z01.00', 'Z01.01') |
       icd_9 %in% c('V72.0')) &
      proc_code %in% c('99172', '99173')                                        ~ "Vision Test",
    
    (icd_10 %in% c('Z00.00', 'Z00.01', 'Z01.411', 'Z01.419', 'Z01.84') |
       icd_9 %in% c('V70.0', 'V72.31', 'V72.61')) &
      proc_code %in% c('87086', '36415', '85025', '85027', '81001', '81002', 
                       '81003', '81000', '81005', '81007', '81015', '81020', 
                       '80050', '93000' , 'U300', 'U301', 'U310', 'U311', 
                       'U312', 'U314', 'U319')                                  ~ "Laboratory Scan",
    
    (str_sub(icd_10, 1, 3) %in% c('Z80', 'Z81', 'Z82', 'Z83', 
                                  'Z84', 'Z85', 'Z86', 'Z87') |
       str_sub(icd_9, 1, 3) %in% c('V10', 'V11', 'V12', 'V13', 'V14', 
                                   'V15', 'V16', 'V17', 'V18', 'V19')) &
      proc_code %in% c('99201', '99202', '99203', '99204', '99205', '99211', 
                       '99212', '99213', '99214', '99215')                      ~ "Disease History Consultation",
    
    (str_sub(icd_10, 1, 3) %in% c('Z11', 'Z12', 'Z13') |
       str_sub(icd_9, 1, 3) %in% c('V73', 'V74', 'V75', 'V76', 'V77', 
                                    'V78', 'V79', 'V80', 'V81', 'V82'))          
                                                                                ~ "Screenings",
    
    str_sub(icd_10, 1, 3) == 'Z94' |
      str_sub(icd_9, 1, 3) == 'V42'                                             ~ "Transplant Check-up",
    
    str_sub(icd_10, 1, 3) == 'Z39' |
      str_sub(icd_9, 1, 3) == 'V24'                                             ~ "Post-Delivery Check-up",
    
    str_sub(icd_10, 1, 3) %in%  c('Z00', 'Z05', "Z23", "Z28", "Z29", "Z71") |
      str_sub(icd_10, 1, 5) %in% c("Z01.0", "Z01.1", "Z01.3", 
                                   "Z01.4", "Z01.2") |
      str_sub(icd_10, 1, 2) %in% c('Z3') |
      icd_9 %in% c('V03.0', 'V03.1', 'V03.2', 'V03.3', 'V03.4', 'V03.5', 
                   'V03.6', 'V03.7', 'V03.81', 'V03.82', 'V03.89', 'V03.9', 
                   'V22.0', 'V22.1', 'V22.3', 'V04.0', 'V04.1', 'V04.2', 
                   'V04.3', 'V04.4', 'V04.5', 'V04.6', 'V04.7', 'V04.81',
                   'V04.82', 'V04.89', 'V05.0', 'V05.1', 'V05.2', 'V05.3', 
                   'V05.4', 'V05.8', 'V05.9', 'V06.0', 'V06.1', 'V06.2', 
                   'V06.3', 'V06.4', 'V06.5', 'V06.6', 'V06.8', 'V06.9',
                   'V25.01', 'V25.02', 'V25.03', 'V25.04', 'V25.09', 'V25.11', 
                   'V25.12', 'V25.13', 'V25.2', 'V25.3', 'V25.40', 'V25.41', 
                   'V25.42', 'V25.43', 'V25.49', 'V25.5', 'V25.8', 'V25.9', 
                   'V24.0', 'V24.1', 'V24.2', 'V30.01', 'V30.1', 'V30.2',
                   'V26.1', 'V26.0', 'V26.9', 'V26.21', 'V26.22', 'V26.29',
                   'V26.31', 'V26.32', 'V26.39', 'V26.33', 'V26.34', 'V26.35',
                   'V26.41', 'V26.42', 'V26.49', 'V26.81', 'V26.82', 'V26.89',
                   'V26.51', 'V26.52', 'V27.0', 'V27.1', 'V27.2', 'V27.3',
                   'V27.4', 'V27.5', 'V27.6', 'V27.7', 'V27.9', 'V28.0', 
                   'V28.1', 'V28.2', 'V28.3', 'V28.82', 'V28.89', 'V30.00', 
                   'V28.4', 'V28.5', 'V28.6', 'V28.81', 'V28.9', 'V78.9',
                   'V31.00', 'V31.01', 'V31.1', 'V31.2', 'V33.1', 'V33.2',
                   'V32.00', 'V32.01', 'V32.1', 'V32.2', 'V33.00', 'V33.01', 
                   'V34.00', 'V34.01', 'V34.1', 'V34.2', 'V35.00', 'V35.01',
                   'V35.1', 'V35.2', 'V36.00', 'V36.01', 'V36.1', 'V36.2',
                   'V37.00', 'V37.01', 'V37.1', 'V37.2', 'V39.00', 'V39.01',
                   'V39.1', 'V39.2', 'V65.0', 'V65.11', 'V65.19', 'V65.41',
                   'V65.42', 'V65.43', 'V65.44', 'V65.45', 'V65.46', 'V70.2',
                   'V65.49', 'V65.2', 'V65.3', 'V65.5', 'V65.8', 'V65.9',
                   'V70.0', 'V70.1', 'V77.99', 'V80.01', 'V80.09', 'V79.9',
                   'V76.0', 'V76.2', 'V76.3', 'V76.4', 'V76.9', 'V73.99',
                   'V76.10', 'V76.11', 'V76.12', 'V76.19', 'V76.41', 'V76.42',
                   'V76.43', 'V76.44', 'V76.45', 'V76.46', 'V76.47', 'V76.49',
                   'V76.50', 'V76.51', 'V76.52', 'V76.81', 'V76.89', 'V80.1',
                   'V80.2', 'V80.3', 'V77.0', 'V77.1', 'V77.2', 'V77.3', 
                   'V77.4', 'V77.5', 'V77.6', 'V77.7', 'V77.8', 'V77.91',
                   'V78.0', 'V78.1', 'V78.2', 'V78.3', 'V78.8', 'V79.0', 
                   'V79.1', 'V79.2', 'V79.3', 'V79.8', 'V81.0', 'V81.1',
                   'V81.2', 'V81.3', 'V81.4', 'V81.5', 'V81.6', 'V82.81', 
                   'V82.89', 'V82.0', 'V82.1', 'V82.2', 'V82.3', 'V82.4',
                   'V82.5', 'V82.6', 'V82.9', 'V82.71', 'V82.79', 'V75.0', 
                   'V75.1', 'V75.2', 'V75.3', 'V75.4', 'V75.5', 'V75.6', 
                   'V75.7', 'V75.8', 'V75.9', 'V74.0', 'V74.1', 'V74.2',
                   'V74.3', 'V74.4', 'V74.5', 'V74.6', 'V74.8', 'V74.9',
                   'V73.0', 'V73.1', 'V73.2', 'V73.3', 'V73.4', 'V73.5', 
                   'V73.6','V73.88', 'V73.89', 'V73.81', 'V73.98')              ~ "Probably Preventive",
    
    
    ###### Routine Maternity Care Logic #######
    
    (str_sub(icd_10, 1, 3) %in% c('Z34', 'Z36', 'Z3A') | 
       icd_10 == 'Z33.1' |
       str_sub(icd_9, 1, 3) %in% c('V22', 'V28') |
       icd_9 == 'V22.2') &
      proc_code %in% c('81000', '81001', '81002', '81003')                      ~ "Maternity: Bacteriuria Screening",
    
    proc_code %in% c('S9443', 'A4281', 'A4282', 'A4283', 'A4284', 'A4285', 
                     'A4286', 'E0602', 'E0603')                                 ~ "Maternity: Breastfeeding Support",
    
    (str_sub(icd_10, 1, 3) %in% c('Z34', 'Z36', 'Z3A') | 
       icd_10 == 'Z33.1'|
       str_sub(icd_9, 1, 3) %in% c('V22', 'V28') |
       icd_9 == 'V22.2') &
      proc_code %in% c('85025', '85027', '86900', '82947', '82948', '82950', 
                       '82951', '82952', '85014', '85018', '86704', '86340', 
                       '80055', '80081', '86850', '86901', '86762', '36415', 
                       '36416')                                                 ~ "Maternity: Blood Test",
    
    (str_sub(icd_10, 1, 3) %in% c('Z34', 'Z36', 'Z3A') | 
       icd_10 == 'Z33.1'|
       str_sub(icd_9, 1, 3) %in% c('V22', 'V28') |
       icd_9 == 'V22.2') &
      proc_code %in% c('88141', '88142', '88143', '88144', '88145', '88146', 
                       '88147', '88148', '88149', '88150', '88151', '88152', 
                       '88153', '88154', '88155', '88164', '88165', '88166', 
                       '88167', '88174', '88175')                               ~ "Maternity: Cervical Cancer Screening",
    
    (str_sub(icd_10, 1, 3) %in% c('Z34', 'Z36', 'Z3A') | 
       icd_10 == 'Z33.1'|
       str_sub(icd_9, 1, 3) %in% c('V22', 'V28') |
       icd_9 == 'V22.2') & 
      proc_code %in% c('86701', '86702', '86703', '87806', '86592', '87850', 
                       '87590', '87591', '87592', '87110', '87270', '87320', 
                       '87490', '87491', '87492', '87623', '87624', '87625')    ~ "Maternity: STD Testing",
    
    (str_sub(icd_10, 1, 3) %in% c('Z34', 'Z36', 'Z3A') | 
       icd_10 == 'Z33.1'|
       str_sub(icd_9, 1, 3) %in% c('V22', 'V28') |
       icd_9 == 'V22.2') & 
      proc_code %in% c('76801', '76802', '76805', '76810', '76811', '76812', 
                       '76813', '76814', '76815', '76816', '76817')             ~ "Maternity: Ultrasound",
    
    (str_sub(icd_10, 1, 3) %in% c('Z34', 'Z36', 'Z3A') | 
       icd_10 == 'Z33.1'|
       str_sub(icd_9, 1, 3) %in% c('V22', 'V28') |
       icd_9 == 'V22.2') & 
      proc_code %in% c('90460', '90461', '90471', '90472', '90473', '90474', 
                       '90632', '90633', '90634', '90636', '90740', '90740', 
                       '90743', '90744', '90746', '90747', '90630', '90654', 
                       '90662', '90685', '90686', '90688', '90620', '90621', 
                       '90733', '90734', '90670', '90732', '90702', '90714', 
                       '90715', 'Q2034', 'Q2035', 'Q2036', 'Q2037', 'Q2038')    ~ "Maternity: Vaccinations",
    
    
    str_sub(icd_10, 1, 3) %in% c('Z37', 'Z38', 'O80', 'O82') |
      str_sub(icd_9, 1, 3) %in% c('V27', 'V30', 'V31', 'V32', 'V33', 'V34', 
                                  'V35', 'V36', 'V37', 'V38', 'V39') |
      icd_9 %in% c('650', '669.71')                                                 ~ "Maternity: Delivery"
  )
  return(x)
}
